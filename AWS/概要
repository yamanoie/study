AWSとは

インフラ環境を瞬時に構築できる。
必要な機材をクラウド上でサービスとしてあらかじめ用意されているため、GUIで必要なものを組み合わせるだけですぐに利用できる。
例えばサーバーはEC2、ネットワークはVPCというサービスでそれぞれ構築できる。




＃　リージョン


AWSにはリージョンと呼ばれるAWSの拠点がある。EC2とVPCを利用する前に、あらかじめどのリージョンにするか選択する必要がある。

北アメリカやヨーロッパ、東南アジアなど様々な地域に存在しており、地域ごとに利用料金が異なる。距離が遠いほど通信に時間がかかるため、サービスを提供する地域に合わせてリージョンを決定する。




＃アベイラビリティゾーン（AZ）

各リージョンにつき最低2個以上のデータセンターが存在する。
AZは地理的に独立しており、冗長構成をとるのに使われる。
例えばAZ-Aの地域で地震が起きてAZ-Aのサーバーがダウンしたとする。
しかしあなたは全く同じ構成でAZ-Cにサービスのクローンを用意していた。
AZ-Cは地震の影響を受けていなかったので、AZ-Aをメインに利用していたサービスをAZ-Cヘ切り替えることで、安心してサービスを継続できる。


＊冗長構成とは、情報システムなどの構成の一種で、設備や装置を複数用意し、一部が故障しても運用を継続できるようにしたもの




＃VPC

Virtual Private Cloud
ユーザー専用のプライベートなクラウド環境を提供するサービスのこと
仮想的な自社専用領域

例えば、EC2同士を内部的に通信したい場合や、RDSとやり取りをしたり、内部と外部のネットワークを繋いだりと、多くのAWSはVPCを利用している。
AWS VPCの強みとしては、ネットワーク設定を簡単にカスタマイズすることが出来る点。

VPCには様々なコンポーネントが用意されており、それらを組み合わせることで自由にネットワーク環境を構築できる。

以下は主要なコンポーネント





・インターネットゲートウェイ　IGW

VPCをインターネット接続できるようにするコンポーネント



・サブネット

VPCという大きなネットワークのくくりの中に、小さいネットワークの集まりを作ることができるコンポーネント。

例えばVPCで全体のネットワーク空間を、下記のアドレス範囲で設定したとする。
10.0.0.0 /16
このアドレスの範囲内で、インターネットと通信できるパブリックなネットワークと、外部から遮断したいプライベートなネットワークを定義する。

10.0.1.0/24…パブリックサブネット（インターネット通信したい）
10.0.2.0/24…プライベートサブネット（インターネットを遮断したい）

このようにサブネットを利用することで、ネットワークごとに役割を与えることができ、管理しやすくなる。

サブネットはAZごとに構成する必要があることと、EC2インスタンスはサブネット内に配置する。



・ルートテーブル

サブネットごとに「どこに接続できるか」を設定するもの。これをきちんと設定することで、システムからの通信経路を制御し、安全性を担保できる。
ネットワークの経路を設定するコンポーネント。

サブネット内の通信がどの宛先のネットワークに対して、どのコンポーネント（IGWとかEC2とか）に転送されて欲しいかを設定。

一つのサブネットに一つのルートテーブルを用意できますが、指定がない場合はVPC作成時に自動生成されるメインルートテーブルがサブネットに割り当てられる。



・Elastic IP　　固定IP

EC2のインスタンスに対して固定IPを割り当てるコンポーネント。独自ドメインのWebサイトを外部公開する場合などに使用。



・NATゲートウェイ

アドレス変換を行うためのコンポーネント。
パブリックサブネットに設置し、プライベートサブネットから外部への通信ができるようにNATする時に使用。






＃構築イメージ

１、まずVPCを用意
２、次にAZを指定
３、インターネットと通信したいサブネットを切り、パブリックサブネットとする
４、パブリックサブネットにインスタンスを立てる。ここには外部からアクセスしてもOKなWebサイトなどを設置。
５、外部と通信したくないプライベートサブネットを作り、データベースなどを設置。
６、プライベートサブネットから外部へ通信させたいときはNATゲートウェイをパブリックサブネットに設置。合わせてルートテーブルの設定。
７、AZ-Aで障害が起きた時のことを考え、AZ-Cに同じ内容でインフラを構築し、冗長構成とする。